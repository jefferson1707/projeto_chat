---
- name: ğŸ—ï¸ Criar ambiente virtual
  command:
    cmd: "python3 -m venv {{ venv_path }}"
    creates: "{{ venv_path }}/bin/activate"

- name: ğŸ“¦ Atualizar pip no virtualenv
  command:
    cmd: "{{ venv_path }}/bin/pip install --upgrade pip"

- name: ğŸ“‹ Instalar dependÃªncias Python
  command:
    cmd: "{{ venv_path }}/bin/pip install -r {{ project_path }}/requirements.txt"

- name: ğŸ”§ Verificar se Flask foi instalado
  command:
    cmd: "{{ venv_path }}/bin/flask --version"
  register: flask_check
  changed_when: false
  ignore_errors: yes

- name: ğŸ”§ Instalar Flask CLI se necessÃ¡rio
  command:
    cmd: "{{ venv_path }}/bin/pip install flask"
  when: flask_check.rc != 0
