name: Deploy to Kubernetes

on:
  push:
    branches: [ main ]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
    - name: 🏗️ Checkout code
      uses: actions/checkout@v4

    - name: 🔐 Configure KUBECONFIG
      run: |
        echo "${{ secrets.RENDER_KUBECONFIG }}" > kubeconfig.yaml
        export KUBECONFIG=kubeconfig.yaml

    - name: 🚀 Deploy to Render Kubernetes
      run: |
        chmod +x scripts/deploy-render.sh
        ./scripts/deploy-render.sh